# 6. 关系数据理论

- 问题提出
  - 数据冗余
  - 更新异常
  - 插入异常
  - 删除异常

- 数据依赖

  - 完整性约束的表现形式
  - 是一个关系内部属性与属性之间的一种约束关系,通过属性间值的相等与否体现出来的数据间相互联系
  - 是现实世界属性间相互联系的抽象
  - 是数据内在的性质
  - 是语义的体现
  - 主要类型
    - 函数依赖(FD)
    - 多值依赖(MVD)
    - 连接依赖

  ![image-20250610181302876](C:\Users\32770\AppData\Roaming\Typora\typora-user-images\image-20250610181302876.png)

## 6.1 函数依赖,码,范式

#### 函数依赖

- 定义

  - 数据库中，若学生表学号确定则姓名唯一确定，此为函数依赖。

    > 学生表（学号，姓名）中，学号→姓名（学号决定姓名）。

*不是指唯一确定,指的是均要满足的条件*

- 如何确定

  - 根据语义

  > "姓名->年龄" 这个函数依赖只有在不允许同名的条件下成立

- 闭包( *X*+)✨

  - 所以依赖放在一起

  >  F = \{A→B, B→C, A→D\}
  >
  > {A\}^+ = \{A, B, C, D\}

- 最小函数依赖集：✨

  - 函数依赖左部最简（单属性）
  - 无冗余依赖（去掉后不影响推导）
  - 无冗余属性 

- 平凡函数依赖与非平凡函数依赖

  - 非平凡函数依赖

  > X->Y,但X⊉ Y X,则X->Y是非平凡函数依赖

  - 平凡函数依赖(必然成立)

  > X->Y,但X⊇Y,则X->Y是非平凡函数依赖

- 完全函数依赖与部分函数依赖✨

  - 完全函数依赖

    > X->Y,但是X的子集不可以

  - 部分函数依赖

    > X->Y,X的部分子集可以

- 传递函数依赖✨

  - 非主属性通过中间属性依赖主码

    > 如员工号→部门号→部门名


#### 码

-  **码**：唯一标识元组的属性或属性组。   
- **候选码**：最小码（无冗余属性），可唯一确定元组。   ✨
- **超码**：包含候选码的属性组（可能含多余属性）。   
- **主码**：从候选码中选定的一个作为主键，唯一标识记录。   
- **全码:** 整个属性组都是码
- **关系**：候选码是最小超码，主码是选中的候选码。
- **主属性**: 包含在任何一个候选码中的属性✨
- **非主属性:** 不包含在任何码中的属性✨

- **外部码:** 在一个关系中是码另一个关系中不是码

#### 范式✨✨✨

数据库设计中为避免数据冗余和异常的规范等级，分1NF、2NF、3NF等。  

- **1NF（第一范式）**  
  
  - **定义**：表中每个字段都是不可分割的原子值。(表里不能有表)  

  > 学生表中“地址”字段不能包含多个地址（如“北京,上海”），需拆分为“省”“市”等独立字段。  
  
- **2NF（第二范式）**  
  
  - **定义**：满足1NF，且非主属性完全依赖于主码（消除部分依赖）。  

  > 订单表（订单号,商品号,商品名,数量）中，“商品名”仅依赖“商品号”（部分依赖），需拆分为订单表和商品表。  
  
- **3NF（第三范式）**  
  - **定义**：满足2NF，且非主属性不传递依赖于主码（消除传递依赖）。  
  
  > 员工表（员工号,部门号,部门名）中，“部门名”通过“部门号”传递依赖“员工号”，需拆分为员工表和部门表。  
  
- **BCNF(BC范式)**
  
  - **定义:** 每一个属性都是(候选)码

  > SJP（S，J，P） 
  >
  >  函数依赖：`(S,J)→P`；`(J,P)→S`  
  >
  >  候选码：`(S,J)` 与 `(J,P)`（属性相交 ）
  >
  >  范式：`SJP ∈ 3NF` 且 `SJP ∈ BCNF`
  
- **核心目标**  

  - 减少数据冗余，提升增删改效率，确保数据一致性。

